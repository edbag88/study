Данный раздел разделен на несколько частей(каждый пункт - это ссылка на соответствующий раздел):

<br>

* [Инструкция по настройке системы на Windows](#Инструкция-по-настройке-системы-на-Windows)
  * [Установка Node.js и npm](#1-Установка-Nodejs-и-npm)
  * [Установка Appium](#2-Установка-Appium)
  * [Установка драйвера UiAutomator2 для Appium](#3-Установка-драйвера-UiAutomator2-для-Appium)
  * [Установка Android Studio](#4-Установка-Android-Studio)
  * [Настройка Android Studio и установка SDK](#5-Настройка-Android-Studio-и-установка-SDK)
  * [Добавление переменной ANDROID_HOME в системные переменные](#6-Добавление-переменной-ANDROID_HOME-в-системные-переменные)
  * [Создание виртуального устройства в Android Studio](#7-Создание-виртуального-устройства-в-Android-Studio)
  * [Установка Java Development Kit (JDK)](#8-Установка-Java-Development-Kit-JDK)
  * [Установка Appium Inspector](#9-Установка-Appium-Inspector)
* [Инструкция по настройке системы на macOS](#Инструкция-по-настройке-системы-на-macOS)
  * [Установка Node.js и npm на macOS](#1-Установка-Nodejs-и-npm-на-macOS)
  * [Установка Appium на macOS](#2-Установка-Appium-на-macOS)
  * [Установка драйвера UiAutomator2 для Appium на macOS](#3-Установка-драйвера-UiAutomator2-для-Appium-на-macOS)
  * [Установка Android Studio на macOS](#4-Установка-Android-Studio-на-macOS)
  * [Настройка Android Studio и установка SDK на macOS](#5-Настройка-Android-Studio-и-установка-SDK-на-macOS)
  * [Добавление переменной ANDROID_HOME в системные переменные на macOS](#6-Добавление-переменной-ANDROID_HOME-в-системные-переменные-на-macOS)
  * [Создание виртуального устройства в Android Studio на macOS](#7-Создание-виртуального-устройства-в-Android-Studio-на-macOS)
  * [Установка Java Development Kit (JDK) на macOS](#8-Установка-Java-Development-Kit-JDK-на-macOS)
  * [Установка Appium Inspector на macOS](#9-Установка-Appium-Inspector-на-macOS)

* [Запуск Appium сервера и Appium Inspector и подключение эмулятору](#10-Запуск-Appium-сервера-и-Appium-Inspector-и-подключение-эмулятору)
* [Основной функционал Appium Inspector](#11-Основной-функционал-Appium-Inspector)
* [Подключение реальный девайс на Android для работы с Appium](#12-Подключение-реальный-девайс-на-Android-для-работы-с-Appium)
* [Подсказка к домашнему заданию](#Подсказка-к-домашнему-заданию)

<br>

# Инструкция по настройке системы на Windows
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

## 1. Установка Node.js и npm
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для начала необходимо проверить установлены ли Node.js и npm на вашем компьютере. Для этого необходимо открыть командную строку и выполнить следующие команды:

```bash
node -v
npm -v
```
Если Node.js и npm не установлены, то вы увидите сообщение об ошибке.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_nodejs_win_0.jpeg)

### Установка Node.js

Для того чтобы установить Node.js и npm необходимо перейти на сайт [Node.js](https://nodejs.org/en/) и скачать актуальную версию. 

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/download_nodejs_win.jpeg)

После скачивания необходимо запустить установщик и следовать инструкциям.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_nodejs_1.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_nodejs_2.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_nodejs_3.jpeg)

Обратите внимание чтобы во время установки были отображены как на скриншоте следующие опции, а именно отображение `Add to PATH` и `npm package manager`.
![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_nodejs_4.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_nodejs_5.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_nodejs_6.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_nodejs_7.jpeg)

После установки необходимо проверить всё ли установилось корректно. Для этого необходимо открыть командную строку и выполнить команды:

```bash
node -v
npm -v
```

Если всё установилось корректно, то вы увидите версии установленных пакетов.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/npm_install.jpeg)

</details>

## 2. Установка Appium
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Установка Appium происходит через npm. Для этого необходимо открыть командную строку и выполнить следующую команду:

```bash
npm install -g appium
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/finish_install_appium.jpeg)

</details>

## 3. Установка драйвера UiAutomator2 для Appium
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для установки драйвера UiAutomator2 необходимо выполнить следующую команду:

```bash
appium driver install uiautomator2
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_driver_uiautomator2.jpeg)

> **Важно!** Если во время ввода команды вы увидите ошибку, подобную этой:

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/error_appium.jpeg)

То необходимо выполнить следующую команду в терминале с **правами администратора!**:

```bash
Set-ExecutionPolicy RemoteSigned
```
И после этого ввести букву `Y` и нажать `Enter`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/fix_error.jpeg)

Далее заново нужно повторить установку драйвера UiAutomator2 по команде:

```bash
appium driver install uiautomator2
```

Если всё прошло успешно, то вы увидите сообщение об успешной установке драйвера.

</details>

## 4. Установка Android Studio
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для установки Android Studio необходимо перейти на [официальный сайт](https://developer.android.com/studio) разработчика и скачать актуальную версию.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/download_android_studio.jpeg)

Указать отметку, что вы прочитали и согласны с условиями лицензионного соглашения и нажать на кнопку `Download Android Studio for Windows`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/download_android_studio_terms.jpeg)

Открыть скачанный файл и следовать инструкциям.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_studio_0.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_studio_1.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_studio_2.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_studio_3.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_studio_4.jpeg)

После установки нажимаем на кнопку `Finish`. 

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_studio_5.jpeg)

Так как была указана отметка `Start Android Studio`, то после нажатия на кнопку откроется Android Studio.
В отобразившемся окне `Import Android Studio settings` указываем отметку `Do not import settings` и нажимаем на кнопку `OK`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_studio_6.jpeg)

В окне `Help improve Android Studio` нажимаем на кнопку `Don't send`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_studio_7.jpeg)

</details>

## 5. Настройка Android Studio и установка SDK

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

После открытия Android Studio будет отображено окно `Welcome to Android Studio`. Нажимаем на кнопку `Next`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/android_studio_setup_0.jpeg)

В окне `Install Type` выбираем `Standard` и нажимаем на кнопку `Next`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/android_studio_setup_1.jpeg)

В окне `Verify Settings` в `Current Settings` отображено что будет скачано и установлено. Нажимаем на кнопку `Next`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/android_studio_setup_2.jpeg)

В окне `License Agreement` в блоке `android-sdk-license` ставим отметку `accept`.
Кликаем на блок `intel-android-extra-license` и ставим отметку `accept` и нажимаем на кнопку `Finish`.
Название блока `intel-android-extra-license` может отличаться в зависимости от вашего пк.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/android_studio_setup_3.jpeg)

Установка зависимостей и sdk может занять некоторое время.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/downloading_components.jpeg)

> **Важно!** Если во время установки вы увидите сообщение об ошибке, подобное этому:

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/alert_virtual.jpeg)

То необходимо включить виртуализацию в BIOS. Для этого необходимо перезагрузить компьютер и во время загрузки нажать на клавишу `F2` или `F12` (в зависимости от производителя вашего пк). В меню BIOS необходимо найти пункт `Virtualization` и включить его.

### Проверка установки зависимостей и установка SDK Platforms вручную

После установки зависимостей откроется окно `Welcome to Android Studio`. В котором необходимо кликнуть на выпадающий список `More Actions` и выбрать пункт `SDK Manager`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/open_android_studio.jpeg)

На вкладке `SDK Platforms` убедитесь, что установлены все необходимые пакеты. Если какие-то пакеты не установлены, то установите их.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/sdk_platforms.jpeg)

Перейти на вкладку `SDK Tools` и убедиться, что установлены все необходимые пакеты. Если какие-то пакеты не установлены, то установите их.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/sdk_tools.jpeg)

</details>

## 6. Добавление переменной ANDROID_HOME в системные переменные

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для того чтобы Appium мог найти SDK Android, необходимо добавить переменную `ANDROID_HOME` в системные переменные. Для этого необходимо выполнить следующие шаги:

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/sdk_location.jpeg)

1. Перейти в `Панель управления` -> `Систем и безопасность` -> `Система` -> `Дополнительные параметры системы`.( Либо открыть окно `Мой компьютер`, кликнуть правой кнопкой мыши и выбрать пункт `Свойства`).
2. В открывшемся окне перейти на вкладку `Дополнительно`/ `Дополнительные параметры системы` и нажать на кнопку `Переменные среды`.
3. В разделе `Системные переменные`/ `Переменные среды пользователя` нажать на кнопку `Создать`.
4. В поле `Имя переменной` ввести `ANDROID_HOME`, а в поле `Значение переменной` ввести путь до папки с SDK Android. Например, `C:\Users\%USERNAME%\AppData\Local\Android\Sdk`.
5. Нажать на кнопку `ОК`.

где `%USERNAME%` - это ваше имя пользователя.

Действия выше нужно проделать как для системной переменной, так и для переменной пользователя.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/path_directory.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/open_path_location_4_1.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/open_path_location_5.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/open_path_location_6.jpeg)

Далее необходимо добавить в переменную `Path` путь до папки `platform-tools` и `tools` внутри папки с SDK Android. Для этого необходимо выполнить следующие шаги:

1. В разделе `Системные переменные`/ `Переменные среды пользователя` найти переменную `Path` и нажать на кнопку `Изменить`.
2. Нажать на кнопку `Создать`.
3. В поле `Имя переменной` ввести `Path` кликнуть на нее два раза, а в пустое поле ввести пути до папок `platform-tools` и `tools` внутри папки с SDK Android. 

Например,

```
C:\Users\%USERNAME%\AppData\Local\Android\Sdk\tools
C:\Users\%USERNAME%\AppData\Local\Android\Sdk\tools\bin 
C:\Users\%USERNAME%\AppData\Local\Android\Sdk\platform-tools
C:\Users\%USERNAME%\AppData\Local\Android\Sdk\platform-tools\adb
C:\Users\%USERNAME%\AppData\Local\Android\Sdk\emulator
```

где `%USERNAME%` - это ваше имя пользователя.

4. Нажать на кнопку `ОК`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/android_path.jpeg)

Данные действия нужно проделать как для системной переменной, так и для переменной пользователя.

> **Mac os**

Для того чтобы добавить переменную `ANDROID_HOME` в Mac OS, необходимо выполнить следующие шаги:
открыть терминал и выполнить следующую команду:

```bash
open .zshrc
```

Откроется файл `.zshrc` в текстовом редакторе. В конец файла добавить следующую строку:

```bash
export PATH=$PATH:/usr/local/bin
export ANDROID_HOME="$HOME/Library/Android/sdk"
export ANDROID_SDK_ROOT="$HOME/Library/Android/sdk"
export PATH="$ANDROID_HOME/tools:$PATH"
export PATH="$ANDROID_HOME/platform-tools:$PATH"
```

source ~/.zshrc

</details>

## 7. Создание виртуального устройства в Android Studio

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Открыть `Android Studio`. 
Кликнуть на выпадающий список `More Actions` и выбрать пункт `Virtual Device Manager`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/virtual_devices.jpeg)

В открывшемся окне нажать на кнопку `Device Manager` необходимо нажать на иконку `+`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/create_device.jpeg)

В окне `Choice a device definition` выбрать устройство, которое вы хотите эмулировать и нажать на кнопку `Next`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/choose_device.jpeg)

На странице `System Image` необходимо выбрать версию Android, которую вы хотите установить на эмуляторе.
Если в строке `Realease Name` нарисована иконка скачивания, то необходимо нажать на нее и дождаться окончания загрузки.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/system_image.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/install_android_13.jpg)

После скачивания данная версия будет доступна для установки.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/add_image_android14.jpeg)

В окне `Verify Configuration` если необходимо можно изменить название устройства и другие параметры. После этого нажать на кнопку `Finish`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/add_name_avd.jpeg)

### Запуск виртуального устройства

Для того чтобы запустить виртуальное устройство, необходимо на странице `Device Manager` в строке с созданным устройством нажать на кнопку `Play`.
Первый раз может отобразиться окно `Adb`, которое необходимо одобрить.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/adb.jpeg)

После этого начнется загрузка виртуального устройства.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/device_loading.jpeg)

После загрузки виртуального устройства можно проверить его отображение в терминале с помощью команды `adb devices`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/adb_device.jpeg)

В терминале будет отображен уникальный идентификатор устройства.

</details>

## 8. Установка Java Development Kit (JDK)
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для установки JDK необходимо перейти на [официальный сайт](https://www.oracle.com/java/technologies/downloads/) разработчика и скачать актуальную версию.

Или же использовать [Azul](https://www.azul.com/downloads/?package=jdk#zulu).

Или [JDK Java](https://jdk.java.net/).

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/azul_jdk.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/azul-download_jdk.jpeg)

Запустить установщик и следовать инструкциям.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/azul_install.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/azul_install_1.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/azul_install_2.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/azul_install_3.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/azul_install_4.jpeg)

Далее необходимо снова перейти в `Системные переменные`/ `Переменные среды пользователя` и проверить есть ли добавленная переменная `JAVA_HOME`. Если ее нет, то добавить ее.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/Java_home.jpeg)

> **Mac os**

Для того чтобы добавить переменную `ANDROID_HOME` в Mac OS, необходимо выполнить следующие шаги:
открыть терминал и выполнить следующую команду:

```bash
open .zshrc
```

Откроется файл `.zshrc` в текстовом редакторе. В конец файла добавить следующую строку:

```bash
export PATH="/opt/homebrew/opt/openjdk/bin:$PATH"
export JAVA_HOME="/Library/Java/JavaVirtualMachines/jdk-21.jdk/Contents/Home"
```

source ~/.zshrc

Далее необходимо проверить видно ли переменную `JAVA_HOME` и `Java` в командной строке. Для этого необходимо выполнить следующие команды:

```bash
java -version
```

```bash
$Env:JAVA_HOME
```

Если переменные установлены корректно, то вы увидите версию установленного JDK и путь до папки с JDK.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/java_install_check.jpeg)


</details>

## 9. Установка Appium Inspector
<details><summary><b>Нажать, чтобы раскрыть</b></summary>


Для установки Appium Inspector необходимо перейти на [страницу GitHub](https://github.com/appium/appium-inspector/releases) проекта и скачать актуальную версию установщика именно для вашей операционной системы.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/download_appium_inspector.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/appium_inspector_download.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/choose_exe_file_appium_inspector.jpeg)

После скачивания необходимо запустить установщик и следовать инструкциям.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/inspector_install.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/open_inspector.jpeg)

</details>
</details>

# Инструкция по настройке системы на macOS
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

## 1. Установка Node.js и npm на macOS
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для начала необходимо проверить установлены ли Node.js и npm на вашем компьютере. Для этого необходимо открыть терминал и выполнить следующие команды:

```bash
node -v
npm -v
```
Если Node.js и npm не установлены, то вы увидите сообщение об ошибке.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/node_npm_not_found.jpeg)

### Установка Node.js

Для того чтобы установить Node.js и npm необходимо перейти на сайт [Node.js](https://nodejs.org/en/) и скачать актуальную версию. 

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/download_node.jpeg)

После скачивания необходимо запустить установщик и следовать инструкциям.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_nodejs_1.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_nodejs_2.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_nodejs_3.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_nodejs_4.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_nodejs_5.jpeg)

После установки необходимо проверить всё ли установилось корректно. Для этого необходимо открыть терминал и выполнить команды:

```bash
node -v
npm -v
```

Если всё установилось корректно, то вы увидите версии установленных пакетов.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/npm_install.jpeg)

</details>

## 2. Установка Appium на macOS
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Установка Appium происходит через npm. Для этого необходимо открыть терминал и выполнить следующую команду:

```bash
npm install -g appium 

или 

sudo npm install -g appium
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/finish_install_appium.jpeg)

</details>

## 3. Установка драйвера UiAutomator2 для Appium на macOS
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для установки драйвера UiAutomator2 необходимо выполнить следующую команду:

```bash
appium driver install uiautomator2

или

sudo appium driver install uiautomator2
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_driver_uiautomator2.jpeg)

Если всё прошло успешно, то вы увидите сообщение об успешной установке драйвера.

</details>

## 4. Установка Android Studio на macOS
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для установки Android Studio необходимо перейти на [официальный сайт](https://developer.android.com/studio) разработчика и скачать актуальную версию.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/download_android_studio.jpeg)

Указать отметку, что вы прочитали и согласны с условиями лицензионного соглашения и нажать на версию в зависимости от вашего процессора.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/download_android_studio_terms.jpeg)

Открыть скачанный файл и следовать инструкциям.

Добавить Android Studio в папку `Applications`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_android_studio_0.jpeg)

Подождать пока произойдет копирование файлов.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_android_studio_1.jpeg)

Открыть `Finder` и перейти в папку `Программы`. Запустить `Android Studio`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_android_studio_2.jpeg)

Одобрить запуск установщика `Android Studio`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_android_studio_3.jpeg)

В окне `Help improve Android Studio` нажимаем на кнопку `Don't send`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_android_studio_4.jpeg)

</details>

## 5. Настройка Android Studio и установка SDK на macOS

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

После открытия Android Studio будет отображено окно `Welcome to Android Studio`. Нажимаем на кнопку `Next`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/android_studio_setup_0.jpeg)

В окне `Install Type` выбираем `Standard` и нажимаем на кнопку `Next`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/android_studio_setup_1.jpeg)

В окне `Verify Settings` в `Current Settings` отображено что будет скачано и установлено. Нажимаем на кнопку `Next`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/android_studio_setup_2.jpeg)

В окне `License Agreement` в блоке `android-sdk-license` ставим отметку `Accept` и нажимаем на кнопку `Finish`.
Название блока `android-sdk-license` может отличаться в зависимости от вашего процессора. А также возможно, что вам придется установить дополнительные компоненты.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/android_studio_setup_3.jpeg)

Установка зависимостей и sdk может занять некоторое время.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/android_studio_setup_4.jpeg)

### Проверка установки зависимостей и установка SDK Platforms вручную

После установки зависимостей откроется окно `Welcome to Android Studio`. В котором необходимо кликнуть на выпадающий список `More Actions` и выбрать пункт `SDK Manager`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/open_android_studio.jpeg)

На вкладке `SDK Platforms` убедитесь, что установлены все необходимые пакеты. Если какие-то пакеты не установлены, то установите их.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/sdk_platforms.jpeg)

Перейти на вкладку `SDK Tools` и убедиться, что установлены все необходимые пакеты. Если какие-то пакеты не установлены, то установите их.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/sdk_tools.jpeg)

</details>

## 6. Добавление переменной ANDROID_HOME в системные переменные на macOS

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для того чтобы Appium мог найти SDK Android, необходимо добавить переменную `ANDROID_HOME` в системные переменные. Для этого необходимо выполнить следующие шаги:

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/sdk_location.jpeg)

Для начала нужно проверить есть ли у вас созданный файл `.zshrc`. Для этого необходимо выполнить следующие команды в терминале:

```bash
~/.zshrc

open .zshrc
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/no_file_zshrc.jpeg)

>Если же файл был найден и открылся, то необходимо пропустить шаг с созданием файла и его открытием.

Если файл `.zshrc` не найден, то необходимо его создать. Для этого необходимо выполнить следующую команду в терминале:

```bash
touch ~/.zshrc
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/create_file_zshrc.jpeg)

После того как файл создан, необходимо его открыть. Необходимо выполнить следующую команду в терминале:

```bash
open .zshrc
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/open_zshrc.jpeg)

Откроется файл `.zshrc` в текстовом редакторе. В конец файла добавить следующую строку:

```bash
export PATH=$PATH:/usr/local/bin
export ANDROID_HOME="$HOME/Library/Android/sdk"
export ANDROID_SDK_ROOT="$HOME/Library/Android/sdk"
export PATH="$ANDROID_HOME/tools:$PATH"
export PATH="$ANDROID_HOME/platform-tools:$PATH"
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/save_data_zshrc.jpeg)

Далее необходимо сохранить файл и закрыть текстовый редактор.

После этого необходимо выполнить следующую команду в терминале:

```bash
source ~/.zshrc
```
Эта команда обновит переменные окружения.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/refresh_data.jpeg)

</details>

## 7. Создание виртуального устройства в Android Studio на macOS

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Открыть `Android Studio`. 
Кликнуть на выпадающий список `More Actions` и выбрать пункт `Virtual Device Manager`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/virtual_devices.jpeg)

В открывшемся окне нажать на кнопку `Device Manager` необходимо нажать на иконку `+`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/create_device.jpeg)

В окне `Choice a device definition` выбрать устройство, которое вы хотите эмулировать и нажать на кнопку `Next`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/choose_device.jpeg)

На странице `System Image` необходимо выбрать версию Android, которую вы хотите установить на эмуляторе.
Если в строке `Realease Name` нарисована иконка скачивания, то необходимо нажать на нее и дождаться окончания загрузки.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/system_image.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/install_android_14.jpeg)

После скачивания данная версия будет доступна для установки.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/add_image_android14.jpeg)

В окне `Verify Configuration` если необходимо можно изменить название устройства и другие параметры. После этого нажать на кнопку `Finish`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/add_name_avd.jpeg)

### Запуск виртуального устройства

Для того чтобы запустить виртуальное устройство, необходимо на странице `Device Manager` в строке с созданным устройством нажать на кнопку `Play`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/run_emulator.jpeg)

После этого начнется загрузка виртуального устройства.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/device_loading.jpeg)

После загрузки виртуального устройства можно проверить его отображение в терминале с помощью команды `adb devices`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/adb_device.jpeg)

В терминале будет отображен уникальный идентификатор устройства.

</details>

## 8. Установка Java Development Kit (JDK) на macOS
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Для установки JDK необходимо перейти на [официальный сайт](https://www.oracle.com/java/technologies/downloads/) разработчика и скачать актуальную версию.

Или же использовать [Azul](https://www.azul.com/downloads/?package=jdk#zulu).

Или [JDK Java](https://jdk.java.net/).

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/azul_jdk.jpeg)

Запустить установщик и следовать инструкциям.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/azul_install.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/azul_install_1.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/azul_install_2.jpeg)

Одобрить установку.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/azul_install_3.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/azul_install_4.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/azul_install_5.jpeg)

Далее необходимо открыть файл `.zshrc` в который добавить переменную `JAVA_HOME`. Для этого необходимо открыть терминал и ввести команду:

```bash
open .zshrc
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/open_zshrc_add_java.jpeg)

Откроется файл `.zshrc` в текстовом редакторе. В конец файла добавить следующие строки:

```bash
export PATH="/opt/homebrew/opt/openjdk/bin:$PATH"
export JAVA_HOME="/Library/Java/JavaVirtualMachines/jdk-21.jdk/Contents/Home"
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/save_data_zshrc.jpeg)

Далее необходимо сохранить файл и закрыть текстовый редактор.

После этого необходимо выполнить следующую команду в терминале:

```bash
source ~/.zshrc
```

Эта команда обновит переменные окружения.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/refresh_data_java_home.jpeg)

Далее необходимо проверить видно ли переменную `JAVA_HOME` и `Java` в командной строке. Для этого необходимо выполнить следующие команды:

```bash
java -version
```

```bash
echo $JAVA_HOME
```

Если переменные установлены корректно, то вы увидите версию установленного JDK и путь до папки с JDK.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/java_install_check.jpeg)


</details>

## 9. Установка Appium Inspector на macOS
<details><summary><b>Нажать, чтобы раскрыть</b></summary>


Для установки Appium Inspector необходимо перейти на [страницу GitHub](https://github.com/appium/appium-inspector/releases) проекта и скачать актуальную версию установщика именно для вашей операционной системы.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/download_appium_inspector.jpeg)

После скачивания необходимо запустить установщик и следовать инструкциям.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/appium_inspector_install.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/appium_inspector_install_1.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/appium_inspector_install_2.jpeg)

Если во время установки будет отображено сообщение, что не удается открыть приложение, то необходимо открыть `Конфиденциальность и безопасность` и разрешить запуск приложения.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/mac/allow_inspector_appium.jpeg)

</details>
</details>

# 10. Запуск Appium сервера и Appium Inspector и подключение эмулятору

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

## Запуск Appium сервера
Для запуска Appium необходимо открыть командную строку и выполнить следующую команду:

```bash
appium
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/start_appium.jpeg)

Необходимо дождаться пока Appium запустится и отобразится сообщение о том, что сервер запущен.
Необходимо проверить не отображено ли ошибок при запуске, а также отображены ли драйверы `UiAutomator2` которые были установлены ранее.

Важно обратить внимание на следующие строки:

```
[Appium] You can provide the following URLs in your client code to connect to this server: 
[Appium] http://127.0.0.1:4723/ (only accessible from the same host)
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/url_appuim.jpeg)

– именно http://127.0.0.1:4723/ является полным «remote url», который используется для создания подключения. 
Для подключения из `Appium Inspector`: Remote Host (127.0.0.1); Remote Port (4723); Remote Path (/).

Есть важный нюанс по Remote Path – раньше он по умолчанию был равен /wd/hub, и полный `remote url` выглядел так `http://127.0.0.1:4723/wd/hub`. Сейчас поменялась, и не нужно указывать `/wd/hub`, но если необходимо запускать appium как ранее, то необходимо передать `--base-path`:

```bash
appium --base-path "/wd/hub"
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/wd_hub_appium.jpeg)


## Запуск Appium Inspector

После запуска Appium сервера нужно запустить Appium Inspector. После запуска Appium Inspector необходимо убедиться что убедиться, что параметры Remote Host, Remote Port, Remote Path соответствуют тем, с которыми запущен Appium-сервер 

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/appium_server.jpeg)

Если запущен Appium сервер с Remote Path как `/wd/hub`, то нужно указать его в Appium Inspector.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/wd_hub_appium_inspector.jpeg)

Иногда при подключении к Appium Inspector может возникнуть ошибка, что не удается подключиться и что необходимо подтвердить неавторизованное подключение. 
Для этого необходимо в Appium Inspector открыть блок `Advanced Settings` и включить опцию `Allow Unauthorized Sertificates`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/allow_unauthorized_sertificates.jpeg)


## Подключение Android эмулятора
**Важно!** Для того чтобы подключить Android эмулятор к Appium Inspector необходимо чтобы appium был запущен и работал.
Необходимо запустить эмулятор в Android Studio и дождаться его загрузки. 
После этого необходимо подключить Appium Inspector к Android эмулятору. Для этого необходимо выполнить следующие шаги:
А именно ввести в поле `Desired Capabilities` следующие минимальные параметры:

```json
{
  "platformName": "Android",
  "appium:automationName": "UiAutomator2"
}
```

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/capabilities_add.jpeg)

Это можно сделать вручную добавляя каждый параметр по отдельности или же воспользоваться блоком `JSON Representation`. 
Через блок `JSON Representation` можно добавить все параметры сразу, вставив их в поле и нажав иконку с дискетой.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/json_representation.jpeg)

После сохранения параметров они будут размещены в поля `Desired Capabilities`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/json_representation_1.jpeg)

Префикс `appium`: в названии параметров можно не писать, он добавится при подключении автоматически при условии установленного чекбокса `Automatically add necessary Appium vendor prefixes on start`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/appium_prefix.jpeg)

После добавления параметров необходимо нажать на кнопку `Start Session`.

После запуска appium inspector в терминале будет отображен лог подключения к эмулятору. 
И если всё прошло успешно, то в Appium Inspector будет отображен экран эмулятора.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/run_emulator.jpeg)

</details>

# 11. Основной функционал Appium Inspector

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

В Appium Inspector есть несколько основных функций, которые помогают в работе с элементами на экране эмулятора.

## Select Elements

`Select Elements` - это функция, которая позволяет выбрать элемент на экране эмулятора и увидеть его XPath, ID, ClassName и другие параметры.
По умолчанию данная функция включена. Необходимо только кликнуть на элемент на экране.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/select_elements.jpeg)

## Search for element

`Search for element` - это функция, которая позволяет искать элемент на экране по его XPath, ID, ClassName и другим параметрам.
Для того чтобы проверить есть ли среди элементов на экране нужный элемент, необходимо кликнуть на иконку лупы, выбрать тип локатора и ввести значение. Далее нажать на кнопку `Search`.

Полный списком поддерживаемых локаторов можно увидеть в [официальном README драйвера UiAutomator2](https://github.com/appium/appium-uiautomator2-driver#element-location) 

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/search_element.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/search_element_1.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/search_element_2.jpeg)

## Tap/Swipe by coordinates

`Tap/Swipe by coordinates` - это функция, которая позволяет тапнуть или свайпнуть по экрану эмулятора по координатам.

Для того чтобы тапнуть по экрану или свайпунть, необходимо кликнуть на иконку с `+` для активации режима выбора координат, выбрать координаты(навести курсор на нужное место и кликнуть).

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/tap_swipe_coordinates.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/tap_swipe_coordinates_1.jpeg)


## Show Element Handles

`Show Element Handles` - это функция, которая позволяет увидеть все кликабельные элементы на экране.

Для того чтобы увидеть все элементы на экране, необходимо переключить переключатель в положение `ON`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/show_element_handles.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/show_element_handles_1.jpeg)

Все кликабельные элементы будут подсвечены красным цветом. Если это иконка `+` то нужно кликнуть и отобразиться несколько параметров элемента на которые можно кликнуть.

</details>

# 12. Подключение реальный девайс на Android для работы с Appium

<details><summary><b>Нажать, чтобы раскрыть</b></summary>

## Подготовка реального устройства к подключению

1. Перейти в настройки устройства;
2. Открыть пункт `О телефоне`;
3. Нажать на пункт `Номер сборки` несколько раз, пока не появится сообщение о том, что режим разработчика активирован;
4. Перейти в настройки разработчика;
5. Активировать режим разработчика;
6. Активировать отладку по USB.
7. Подключить устройство к компьютеру через USB-кабель.
8. При первом подключении устройства к компьютеру необходимо дать разрешение на подключение к компьютеру, выбрав пункт `Всегда разрешать...`.
9. После подключения устройства проверить его отображение с помощью команды `adb devices`.
10. Если необходимо, можно настроить [дополнительные опции](https://developer.android.com/studio/debug/dev-options#general), например, включить опцию «Stay Awake» («Не выключать экран»)

## Подключение реального устройства к Appium и запуск apk

Для начала необходимо скачать apk файл, который будет тестироваться. Как пример [wikipedia.apk](https://github.com/wikimedia/apps-android-wikipedia/releases/tag/latest)
Далее необходимо запустить Appium и Appium Inspector. После этого необходимо подключить устройство к компьютеру и дождаться его отображения в терминале с помощью команды `adb devices`.

В Appium Inspector необходимо добавить параметры для подключения к устройству:

```json
{
  "platformName": "Android",
  "appium:automationName": "UiAutomator2",
  "appium:app": "<YOUR-PATH-TO-PROJECT>/app-alpha-universal-release.apk",
  "appium:appWaitActivity": "org.wikipedia.*"
}
```

Опция `appium:app` - это путь до apk файла, который будет тестироваться.
Опция `appium:appWaitActivity` - это активити, которая будет открыта после запуска apk файла. Чаще всего ее не используют, или же используют `*` если нужно указать любую активити.

После добавления параметров необходимо нажать на кнопку `Start Session`.

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/conect_real_device.jpeg)

![](https://raw.githubusercontent.com/qa-guru/knowledge-base/main/img/python/les20/real_apk_device.jpeg)


Если одновременно подключено более одного устройства, например – эмулятор и реальный девайс, то надо либо оставить только одно устройство подключенным (закрыв, например, эмулятор), либо дополнительно указать опцию deviceName:

``` 
"appium:deviceName": "<YOUR-DEVICE-NAME>"
```

`YOUR-DEVICE-NAME` – это имя вашего устройства.


или опцию udid:

```
"appium:udid": "<YOUR-DEVICE-UDID>"
```

`YOUR-DEVICE-UDID` – это уникальный идентификатор вашего устройства, который можно узнать с помощью команды `adb devices`.

</details>

#  Подсказка к домашнему заданию
<details><summary><b>Нажать, чтобы раскрыть</b></summary>

Ты увидишь полное решение реализации, если нажмешь на кнопку ниже.
Ты уверен, что хочешь это сделать?
<details><summary><b>Да, я осознаю все риски, и спишу</b></summary>

А может подумаешь еще раз?
<details><summary><b>Уже думал, хочу списать</b></summary>

А может загуглить самостоятельно?
<details><summary><b>Не помогло, дай списать</b></summary>

Спишешь, но не скажешь никому?
<details><summary><b>Так и думал/ла сделать</b></summary>

А вдруг ты сможешь сам?
<details><summary><b>Может, но не сейчас</b></summary>

Ладно, смотри решение, но не забудь разобраться в нем.
<details><summary><b>Обязуюсь разобраться после того как спишу</b></summary>

Пример реализации конфигурации, а именно файл config.py:
<details><summary><b>Пример реализации конфигурации, а именно файл config.py</b></summary>

```python
import os
from dotenv import load_dotenv
from appium.options.android import UiAutomator2Options
import utils


def to_driver_options(context):
    options = UiAutomator2Options()

    if context == 'local_emulator':
        options.set_capability('remote_url', os.getenv('REMOTE_URL')) # адрес удаленного сервера
        options.set_capability('deviceName', os.getenv('DEVICE_NAME')) # имя устройства
        options.set_capability('appWaitActivity', os.getenv('APP_WAIT_ACTIVITY')) # активити, которая будет открыта после запуска apk файла
        #options.set_capability('udid', os.getenv('UDID')) # уникальный идентификатор устройства 
        options.set_capability('app', utils.file.abs_path_from_project(os.getenv('APP'))) # путь до apk файла

    if context == 'local_real_device':
        options.set_capability('remote_url', os.getenv('REMOTE_URL'))
        options.set_capability('deviceName', os.getenv('DEVICE_NAME'))
        options.set_capability('appWaitActivity', os.getenv('APP_WAIT_ACTIVITY'))
        #options.set_capability('udid', os.getenv('UDID'))
        options.set_capability('app', utils.file.path_from_project(os.getenv('APP')))
        

    if context == 'bstack':
        options.set_capability('remote_url', os.getenv('REMOTE_URL'))
        options.set_capability('deviceName', os.getenv('DEVICE_NAME'))
        options.set_capability('platformName', os.getenv('PLATFORM_NAME'))
        options.set_capability('platformVersion', os.getenv('PLATFORM_VERSION'))
        options.set_capability('appWaitActivity', os.getenv('APP_WAIT_ACTIVITY'))
        options.set_capability('app', os.getenv('APP'))
        load_dotenv(dotenv_path=utils.file.path_from_project('.env.credentials')) # загрузка переменных окружения из файла .env.credentials
        options.set_capability(
            'bstack:options', {
                'projectName': 'Wikipedia project',
                'buildName': 'browserstack-build-1',
                'sessionName': 'BStack test',
                'userName': os.getenv('USER_NAME'),
                'accessKey': os.getenv('ACCESS_KEY'),
            },
        )

    return options
```

Env файлы могут быть реализованы следующим образом:

.env.local_emulator

```env
REMOTE_URL='http://127.0.0.1:4723' # адрес удаленного сервера
DEVICE_NAME='emulator-5554' # имя устройства, его можно узнать с помощью команды 'adb devices'
APP_WAIT_ACTIVITY='org.wikipedia.*' # активити, которая будет открыта после запуска apk файла
APP='./app-alpha-universal-release.apk' # название apk файла
```

.env.local_real_device

```env
REMOTE_URL='http://127.0.0.1:4723'
DEVICE_NAME='****' # имя реального устройства, его можно узнать с помощью команды 'adb devices'
APP_WAIT_ACTIVITY='org.wikipedia.*'
APP='./app-alpha-universal-release.apk'
```

.env.bstack
```env
REMOTE_URL='http://hub.browserstack.com/wd/hub' # адрес удаленного сервера BrowserStack
DEVICE_NAME='Google Pixel 3' # имя устройства BrowserStack
PLATFORM_NAME='Android' # платформа Android
PLATFORM_VERSION='9.0' # версия Android
APP_WAIT_ACTIVITY='org.wikipedia.*' # активити, которая будет открыта после запуска apk файла
APP='bs://*********' # ссылка на apk файл в BrowserStack
```

.env.credentials
```env
USER_NAME='*****' # имя пользователя BrowserStack
ACCESS_KEY='*****' # ключ доступа к аккаунту BrowserStack
```

</details>

<details><summary><b>Пример файла conftest.py</b></summary>

```python
import pytest
from appium import webdriver
from dotenv import load_dotenv
from selene import browser

import config
from utils import attach


def pytest_addoption(parser):
    parser.addoption(
        "--context",
        default="bstack",
        help="Specify the test context"
    )


def pytest_configure(config):
    context = config.getoption("--context")
    env_file_path = f".env.{context}"

    load_dotenv(dotenv_path=env_file_path)


@pytest.fixture
def context(request):
    return request.config.getoption("--context")


@pytest.fixture(scope='function', autouse=True)
def mobile_management(context):
    options = config.to_driver_options(context=context)

    browser.config.driver = webdriver.Remote(options.get_capability('remote_url'), options=options)
    browser.config.timeout = 10.0

    yield

    attach.add_screenshot()
    attach.add_xml()
    session_id = browser.driver.session_id

    browser.quit()

    if context == 'bstack':
        attach.add_video(session_id)
```

Пример запуска тестов при реализации описанной выше

```bash
pytest # при не указании параметра --context будет запущен тест в контексте bstack, это равноценно команде pytest --context=bstack

pytest --context=local_emulator # запуск теста в контексте local_emulator

pytest --context=local_real_device # запуск теста в контексте local_real_device

pytest --context=bstack # запуск теста в контексте bstack
```
</details>
</details>
</details>
</details>
</details>
</details>
</details>
</details>